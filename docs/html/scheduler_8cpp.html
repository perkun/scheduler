<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Scheduler for OA Cluster: /home/grzeslaff/projects/scheduler/src/scheduler.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Scheduler for OA Cluster
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">scheduler.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;sys/ipc.h&gt;</code><br />
<code>#include &lt;sys/msg.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;map&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;pqxx/pqxx&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;algorithm&gt;</code><br />
<code>#include &quot;<a class="el" href="MessageQueue_8h_source.html">MessageQueue.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Job_8h_source.html">Job.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Options_8h_source.html">Options.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="Computer_8h_source.html">Computer.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2a37b4217917105aac7557862ccc19c3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a2a37b4217917105aac7557862ccc19c3">MAXSIZE</a>&#160;&#160;&#160;128</td></tr>
<tr class="separator:a2a37b4217917105aac7557862ccc19c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af146b7ef05ccd3f7adf9019f9dd8ab22"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#af146b7ef05ccd3f7adf9019f9dd8ab22">MAX_WAITING_JOBS</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:af146b7ef05ccd3f7adf9019f9dd8ab22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e8be9e9f35490876bd26d38cebcd3e4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a3e8be9e9f35490876bd26d38cebcd3e4">MAX_EXECUTING_JOBS</a>&#160;&#160;&#160;100</td></tr>
<tr class="separator:a3e8be9e9f35490876bd26d38cebcd3e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2019b8356fc18e92679cc4726250ab2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#aa2019b8356fc18e92679cc4726250ab2">JOB_TIMEOUT_SECONDS</a>&#160;&#160;&#160;120</td></tr>
<tr class="separator:aa2019b8356fc18e92679cc4726250ab2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78a7c96eb84d6f1105532833a1dfeb00"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a78a7c96eb84d6f1105532833a1dfeb00">MAX_COMPUTER_RESOURCES</a>&#160;&#160;&#160;1900</td></tr>
<tr class="separator:a78a7c96eb84d6f1105532833a1dfeb00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dde15c222f8ae1872f0a5ec6bc3fe45"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a3dde15c222f8ae1872f0a5ec6bc3fe45">mutator_scheduler_queue</a>&#160;&#160;&#160;1000</td></tr>
<tr class="separator:a3dde15c222f8ae1872f0a5ec6bc3fe45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b2c3ece5bf507c8551c787d4e02e44e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a1b2c3ece5bf507c8551c787d4e02e44e">scheduler_mutator_queue</a>&#160;&#160;&#160;1001</td></tr>
<tr class="separator:a1b2c3ece5bf507c8551c787d4e02e44e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad224d558ff8bd7aaafd409b2eae52480"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#ad224d558ff8bd7aaafd409b2eae52480">scheduler_crankshaft_queue</a>&#160;&#160;&#160;2001</td></tr>
<tr class="separator:ad224d558ff8bd7aaafd409b2eae52480"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab695b19435748d52608e2fd09614781c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#ab695b19435748d52608e2fd09614781c">crankshaft_scheduler_queue</a>&#160;&#160;&#160;2000</td></tr>
<tr class="separator:ab695b19435748d52608e2fd09614781c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0c30eb0b70426053d17fa21865493ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#af0c30eb0b70426053d17fa21865493ff">scheduler_manager_queue</a>&#160;&#160;&#160;5000</td></tr>
<tr class="separator:af0c30eb0b70426053d17fa21865493ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a312d5a37bfda94409612a1bf77a9d01e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a312d5a37bfda94409612a1bf77a9d01e">mutator_status_queue</a>&#160;&#160;&#160;6000</td></tr>
<tr class="separator:a312d5a37bfda94409612a1bf77a9d01e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadec450609626bd94656f69216119369"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#aadec450609626bd94656f69216119369">crankshaft_status_queue</a>&#160;&#160;&#160;7000</td></tr>
<tr class="separator:aadec450609626bd94656f69216119369"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25cf89b510cd5849cbe4c61185378f09"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a25cf89b510cd5849cbe4c61185378f09">mutator_scheduler_msgt</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a25cf89b510cd5849cbe4c61185378f09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed3b05f534702430c06616f376980d29"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#aed3b05f534702430c06616f376980d29">crankshaft_scheduler_msgt</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:aed3b05f534702430c06616f376980d29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff259060e6dd3848f5e02f22b981a294"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#aff259060e6dd3848f5e02f22b981a294">scheduler_crankshaft_msgt</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:aff259060e6dd3848f5e02f22b981a294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70f5812aa16575a48da83ad65d4e09bf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a70f5812aa16575a48da83ad65d4e09bf">scheduler_manager_msgt</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a70f5812aa16575a48da83ad65d4e09bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71ac22190d96c4dfe038f8dc8c25ec84"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a71ac22190d96c4dfe038f8dc8c25ec84">scheduler_mutator_msgt</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a71ac22190d96c4dfe038f8dc8c25ec84"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aada328618d25df5dcd6c4cc0ce16c17a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#aada328618d25df5dcd6c4cc0ce16c17a">executeNewJobs</a> (map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;jobs, vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;computers)</td></tr>
<tr class="memdesc:aada328618d25df5dcd6c4cc0ce16c17a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes jobs with <a class="el" href="classJob.html#a5cc7599f97df55d76c4f86a130285884a24d459a81449d7210c8f9a86c2913034">Job::Status::NEW</a>.  <a href="#aada328618d25df5dcd6c4cc0ce16c17a">More...</a><br /></td></tr>
<tr class="separator:aada328618d25df5dcd6c4cc0ce16c17a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22b79965ae836e02ee4a5fd9aa503d78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a22b79965ae836e02ee4a5fd9aa503d78">executeWaitingJobs</a> (map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;jobs, vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;computers)</td></tr>
<tr class="memdesc:a22b79965ae836e02ee4a5fd9aa503d78"><td class="mdescLeft">&#160;</td><td class="mdescRight">Executes jobs with <a class="el" href="classJob.html#a5cc7599f97df55d76c4f86a130285884a1869d56535e8b1449a6da54ff5e11f50">Job::Status::WAITING</a>.  <a href="#a22b79965ae836e02ee4a5fd9aa503d78">More...</a><br /></td></tr>
<tr class="separator:a22b79965ae836e02ee4a5fd9aa503d78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cbc52a3507ec979e3a2a82d7302480f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a3cbc52a3507ec979e3a2a82d7302480f">manageFinishedJobs</a> (map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;jobs, vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;computers)</td></tr>
<tr class="memdesc:a3cbc52a3507ec979e3a2a82d7302480f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manages jobs with status <a class="el" href="classJob.html#a5cc7599f97df55d76c4f86a130285884a2c616b2713e2e0aed04b4c4752c88133">Job::Status::FINISHED</a> (correctly calculated jobs).  <a href="#a3cbc52a3507ec979e3a2a82d7302480f">More...</a><br /></td></tr>
<tr class="separator:a3cbc52a3507ec979e3a2a82d7302480f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae893fec9d24ba7255afaf268b615d3fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#ae893fec9d24ba7255afaf268b615d3fa">manageTimeoutedJobs</a> (map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;jobs)</td></tr>
<tr class="memdesc:ae893fec9d24ba7255afaf268b615d3fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Looks for jobs executing longer than JOB_TIMEOUT_SECONDS = 120.  <a href="#ae893fec9d24ba7255afaf268b615d3fa">More...</a><br /></td></tr>
<tr class="separator:ae893fec9d24ba7255afaf268b615d3fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77a422fbe37fd50643975e7d936293aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a77a422fbe37fd50643975e7d936293aa">manageErrorJobs</a> (map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;jobs, vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;computers)</td></tr>
<tr class="memdesc:a77a422fbe37fd50643975e7d936293aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">If a job has status <a class="el" href="classJob.html#a5cc7599f97df55d76c4f86a130285884abb1ca97ec761fc37101737ba0aa2e7c5">Job::Status::ERROR</a>, the status is set to <a class="el" href="classJob.html#a5cc7599f97df55d76c4f86a130285884a24d459a81449d7210c8f9a86c2913034">Job::Status::NEW</a> and the job is scheduled again.  <a href="#a77a422fbe37fd50643975e7d936293aa">More...</a><br /></td></tr>
<tr class="separator:a77a422fbe37fd50643975e7d936293aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80f69e9bae5232af5add6da3d7513a6f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a80f69e9bae5232af5add6da3d7513a6f">updateStatusFromCrankshaft</a> (map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;jobs)</td></tr>
<tr class="memdesc:a80f69e9bae5232af5add6da3d7513a6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads message queue from Crankshaft (finished jobs)  <a href="#a80f69e9bae5232af5add6da3d7513a6f">More...</a><br /></td></tr>
<tr class="separator:a80f69e9bae5232af5add6da3d7513a6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cb926ea3887711943bde8a73b356e7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a1cb926ea3887711943bde8a73b356e7a">deleteFromServices</a> (string ip)</td></tr>
<tr class="memdesc:a1cb926ea3887711943bde8a73b356e7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes computer form DataBase WHERE computer_ip == ip.  <a href="#a1cb926ea3887711943bde8a73b356e7a">More...</a><br /></td></tr>
<tr class="separator:a1cb926ea3887711943bde8a73b356e7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fe7ab449891853d20ed052c7095d89a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a0fe7ab449891853d20ed052c7095d89a">importServices</a> (vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;computers)</td></tr>
<tr class="memdesc:a0fe7ab449891853d20ed052c7095d89a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Imports and updates computers based on DataBase.  <a href="#a0fe7ab449891853d20ed052c7095d89a">More...</a><br /></td></tr>
<tr class="separator:a0fe7ab449891853d20ed052c7095d89a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae725eb5a1223281b6fc69957ba6f6533"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#ae725eb5a1223281b6fc69957ba6f6533">pushBackJobsFromMessages</a> (map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;jobs, vector&lt; string &gt; messages)</td></tr>
<tr class="memdesc:ae725eb5a1223281b6fc69957ba6f6533"><td class="mdescLeft">&#160;</td><td class="mdescRight">For each message in messages creates a job (message parsing in constructor) and appends to jobs.  <a href="#ae725eb5a1223281b6fc69957ba6f6533">More...</a><br /></td></tr>
<tr class="separator:ae725eb5a1223281b6fc69957ba6f6533"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e3772723adc21279b701a4262b4cbb4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a5e3772723adc21279b701a4262b4cbb4">clearEmtyItems</a> (map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;jobs)</td></tr>
<tr class="memdesc:a5e3772723adc21279b701a4262b4cbb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears items with empty vectors.  <a href="#a5e3772723adc21279b701a4262b4cbb4">More...</a><br /></td></tr>
<tr class="separator:a5e3772723adc21279b701a4262b4cbb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1374933b8e84edbf435a2d4e620fda54"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classComputer.html">Computer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a1374933b8e84edbf435a2d4e620fda54">findFreeComputer</a> (vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;computers, int job_service, int job_resources)</td></tr>
<tr class="memdesc:a1374933b8e84edbf435a2d4e620fda54"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns <a class="el" href="classComputer.html">Computer</a> pointer form computers list with lowest number of resources used.  <a href="#a1374933b8e84edbf435a2d4e620fda54">More...</a><br /></td></tr>
<tr class="separator:a1374933b8e84edbf435a2d4e620fda54"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5846ebc28e232e63c7cdec804407fadb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classComputer.html">Computer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a5846ebc28e232e63c7cdec804407fadb">findLeastOccupiedComputer</a> (vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;computers, int job_service)</td></tr>
<tr class="memdesc:a5846ebc28e232e63c7cdec804407fadb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns pointer to <a class="el" href="classComputer.html">Computer</a> with least amount of running jobs.  <a href="#a5846ebc28e232e63c7cdec804407fadb">More...</a><br /></td></tr>
<tr class="separator:a5846ebc28e232e63c7cdec804407fadb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a910e1c58008fb0fae33447cabf3ab6dd"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classComputer.html">Computer</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a910e1c58008fb0fae33447cabf3ab6dd">findBlockedComputer</a> (vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;computers, long unique_id, int job_resources)</td></tr>
<tr class="memdesc:a910e1c58008fb0fae33447cabf3ab6dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches for a computer reserved for the job.  <a href="#a910e1c58008fb0fae33447cabf3ab6dd">More...</a><br /></td></tr>
<tr class="separator:a910e1c58008fb0fae33447cabf3ab6dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a011ae6b48b7ba828575ad798068e9440"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a011ae6b48b7ba828575ad798068e9440">releaseComputer</a> (vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;computers, <a class="el" href="classJob.html">Job</a> *job)</td></tr>
<tr class="memdesc:a011ae6b48b7ba828575ad798068e9440"><td class="mdescLeft">&#160;</td><td class="mdescRight">Searches the computer witch executes the job and frees its resources.  <a href="#a011ae6b48b7ba828575ad798068e9440">More...</a><br /></td></tr>
<tr class="separator:a011ae6b48b7ba828575ad798068e9440"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f83ceb5fbaf42022a10bf37246a9ae0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a1f83ceb5fbaf42022a10bf37246a9ae0">printStats</a> (map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;jobs, vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; computers)</td></tr>
<tr class="memdesc:a1f83ceb5fbaf42022a10bf37246a9ae0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prints info on computers' load and number of tasks per priority.  <a href="#a1f83ceb5fbaf42022a10bf37246a9ae0">More...</a><br /></td></tr>
<tr class="separator:a1f83ceb5fbaf42022a10bf37246a9ae0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a160f14b7b2831c36414f995bf11bc6b8"><td class="memItemLeft" align="right" valign="top">const char *const&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a160f14b7b2831c36414f995bf11bc6b8">boolToString</a> (bool b)</td></tr>
<tr class="separator:a160f14b7b2831c36414f995bf11bc6b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd054ff1e43b113756737ef6cb445111"><td class="memItemLeft" align="right" valign="top">connection&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#acd054ff1e43b113756737ef6cb445111">services</a> (&quot;dbname=grzeslaff user=grzeslaff password=grigori8 hostaddr=150.254.66.29 &quot;)</td></tr>
<tr class="separator:acd054ff1e43b113756737ef6cb445111"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05b80c5ffa05a1c7ddd04c06280ecaf7"><td class="memItemLeft" align="right" valign="top">nontransaction&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a05b80c5ffa05a1c7ddd04c06280ecaf7">servicesTransaction</a> (<a class="el" href="scheduler_8cpp.html#acd054ff1e43b113756737ef6cb445111">services</a>,&quot;Services transaction&quot;)</td></tr>
<tr class="separator:a05b80c5ffa05a1c7ddd04c06280ecaf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a06b3647d8639aac2e8b658f2a6d7f581"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMessageQueue.html">MessageQueue</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a06b3647d8639aac2e8b658f2a6d7f581">msq</a></td></tr>
<tr class="separator:a06b3647d8639aac2e8b658f2a6d7f581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad66547e0931671c3285835bdb8439794"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#ad66547e0931671c3285835bdb8439794">current_priority_counter</a> = 0</td></tr>
<tr class="separator:ad66547e0931671c3285835bdb8439794"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cc149d5e2616cf33ceeb3a1f452f8ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="scheduler_8cpp.html#a4cc149d5e2616cf33ceeb3a1f452f8ac">current_priority</a> = 1</td></tr>
<tr class="separator:a4cc149d5e2616cf33ceeb3a1f452f8ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="aed3b05f534702430c06616f376980d29"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define crankshaft_scheduler_msgt&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ab695b19435748d52608e2fd09614781c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define crankshaft_scheduler_queue&#160;&#160;&#160;2000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aadec450609626bd94656f69216119369"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define crankshaft_status_queue&#160;&#160;&#160;7000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aa2019b8356fc18e92679cc4726250ab2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define JOB_TIMEOUT_SECONDS&#160;&#160;&#160;120</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a78a7c96eb84d6f1105532833a1dfeb00"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_COMPUTER_RESOURCES&#160;&#160;&#160;1900</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3e8be9e9f35490876bd26d38cebcd3e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_EXECUTING_JOBS&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af146b7ef05ccd3f7adf9019f9dd8ab22"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_WAITING_JOBS&#160;&#160;&#160;100</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a2a37b4217917105aac7557862ccc19c3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAXSIZE&#160;&#160;&#160;128</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a25cf89b510cd5849cbe4c61185378f09"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mutator_scheduler_msgt&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a3dde15c222f8ae1872f0a5ec6bc3fe45"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mutator_scheduler_queue&#160;&#160;&#160;1000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a312d5a37bfda94409612a1bf77a9d01e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define mutator_status_queue&#160;&#160;&#160;6000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="aff259060e6dd3848f5e02f22b981a294"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define scheduler_crankshaft_msgt&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad224d558ff8bd7aaafd409b2eae52480"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define scheduler_crankshaft_queue&#160;&#160;&#160;2001</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a70f5812aa16575a48da83ad65d4e09bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define scheduler_manager_msgt&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="af0c30eb0b70426053d17fa21865493ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define scheduler_manager_queue&#160;&#160;&#160;5000</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a71ac22190d96c4dfe038f8dc8c25ec84"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define scheduler_mutator_msgt&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a1b2c3ece5bf507c8551c787d4e02e44e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define scheduler_mutator_queue&#160;&#160;&#160;1001</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a160f14b7b2831c36414f995bf11bc6b8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char *const boolToString </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>b</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a5e3772723adc21279b701a4262b4cbb4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clearEmtyItems </td>
          <td>(</td>
          <td class="paramtype">map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>jobs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears items with empty vectors. </p>

</div>
</div>
<a class="anchor" id="a1cb926ea3887711943bde8a73b356e7a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void deleteFromServices </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ip</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deletes computer form DataBase WHERE computer_ip == ip. </p>
<p>New jobs will not be scheduled for this computer any more. <a class="el" href="classComputer.html">Computer</a> needs to be added manually to the DB after making sure it is operational again. </p>

</div>
</div>
<a class="anchor" id="aada328618d25df5dcd6c4cc0ce16c17a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void executeNewJobs </td>
          <td>(</td>
          <td class="paramtype">map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>jobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>computers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes jobs with <a class="el" href="classJob.html#a5cc7599f97df55d76c4f86a130285884a24d459a81449d7210c8f9a86c2913034">Job::Status::NEW</a>. </p>
<p>Prioritizing of the jobs is performed here <code>'online'</code>; e.g. jobs with priority 10 will be executed 10 times more often than ones with priority 1. If no computer is available (<code>NULL</code> pointer returned by findFreeComputer) function returns. If a job is of <a class="el" href="classJob.html#a22d99024a198d381c702eb09f3958a02a33024e17254c0fa87b3fb84dc02f1def">Job::Type::ESTIMATE_RESOURCES</a> a computer is blocked (this job needs an empty computer to estimate resources on GPU).</p>
<p>If there is a free computer, a job is sent to it. </p>

</div>
</div>
<a class="anchor" id="a22b79965ae836e02ee4a5fd9aa503d78"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void executeWaitingJobs </td>
          <td>(</td>
          <td class="paramtype">map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>jobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>computers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Executes jobs with <a class="el" href="classJob.html#a5cc7599f97df55d76c4f86a130285884a1869d56535e8b1449a6da54ff5e11f50">Job::Status::WAITING</a>. </p>
<p><a class="el" href="classJob.html">Job</a> with <b>WAITING</b> Status has a computer blocked for it. <a class="el" href="classComputer.html">Computer</a> object has two members for that (<code>bool blocked</code> and <code>int blocking_job_id</code>). This function checks if computer reserved for this job has enough resources and if yes, send the job to Crankshaft and unblocks the computer. </p>

</div>
</div>
<a class="anchor" id="a910e1c58008fb0fae33447cabf3ab6dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classComputer.html">Computer</a> * findBlockedComputer </td>
          <td>(</td>
          <td class="paramtype">vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>computers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>unique_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>job_resources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Searches for a computer reserved for the job. </p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><code>NULL</code> if there is no computer reserved for the job (which shouldn't happen) or a blocked computer has no available resources to run the job</li>
<li><code>Computer*</code> otherwise </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a1374933b8e84edbf435a2d4e620fda54"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classComputer.html">Computer</a> * findFreeComputer </td>
          <td>(</td>
          <td class="paramtype">vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>computers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>job_service</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>job_resources</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns <a class="el" href="classComputer.html">Computer</a> pointer form computers list with lowest number of resources used. </p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><code>NULL</code> If all computers are blocked, or <code>computer[i].resources + job_resources &gt; MAX_COMPUTER_RESOURCES</code> (i.e. the job cannot be scheduled to any of the machines) <br />
</li>
<li>Computer* otherwise. </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a5846ebc28e232e63c7cdec804407fadb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classComputer.html">Computer</a> * findLeastOccupiedComputer </td>
          <td>(</td>
          <td class="paramtype">vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>computers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>job_service</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns pointer to <a class="el" href="classComputer.html">Computer</a> with least amount of running jobs. </p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><code>NULL</code> if all computers with appropriate service are blocked</li>
<li><code>Computer*</code> otherwise </li>
</ul>
</dd></dl>

</div>
</div>
<a class="anchor" id="a0fe7ab449891853d20ed052c7095d89a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void importServices </td>
          <td>(</td>
          <td class="paramtype">vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>computers</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Imports and updates computers based on DataBase. </p>
<p>It is performed in every iteration so computers list is always up to date. </p>

</div>
</div>
<a class="anchor" id="a0ddf1224851353fc92bfbff6f499fa97"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<h2>MAIN FUNCTION</h2>
<h3>Initialization:</h3>
<ul>
<li>connects to database <code>grzeslaff</code> with (computer_ip, service) table</li>
<li>sets <code>current_priority = 1</code>, <code>current_priority_counter = 0</code></li>
<li>clears queues</li>
<li>sends message to MANAGER that it started</li>
<li>enters Main Loop </li>
</ul>
<p>list of available computers. Updated at the beginning of every iteration</p>
<h3>Main Loop:</h3>
<ol type="1">
<li>imports services from database. If no computers are available, sleeps for 1 sec</li>
<li>updates status of sent jobs from Crankshaft</li>
<li>manages Finished jobs</li>
<li>manages jobs with errors</li>
<li>reads queue from mutators and ads new jobs</li>
<li>executes waiting jobs</li>
<li>executes new jobs</li>
<li>manages time-outed jobs</li>
<li>if in verbose mode, prints stats about computers</li>
<li>sleeps for 0.2 sec</li>
</ol>

</div>
</div>
<a class="anchor" id="a77a422fbe37fd50643975e7d936293aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void manageErrorJobs </td>
          <td>(</td>
          <td class="paramtype">map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>jobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>computers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If a job has status <a class="el" href="classJob.html#a5cc7599f97df55d76c4f86a130285884abb1ca97ec761fc37101737ba0aa2e7c5">Job::Status::ERROR</a>, the status is set to <a class="el" href="classJob.html#a5cc7599f97df55d76c4f86a130285884a24d459a81449d7210c8f9a86c2913034">Job::Status::NEW</a> and the job is scheduled again. </p>

</div>
</div>
<a class="anchor" id="a3cbc52a3507ec979e3a2a82d7302480f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void manageFinishedJobs </td>
          <td>(</td>
          <td class="paramtype">map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>jobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>computers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Manages jobs with status <a class="el" href="classJob.html#a5cc7599f97df55d76c4f86a130285884a2c616b2713e2e0aed04b4c4752c88133">Job::Status::FINISHED</a> (correctly calculated jobs). </p>
<p>The computer is freed, job's clock is stopped and the job is removed from jobs list. A message to Mutator is sent. </p>

</div>
</div>
<a class="anchor" id="ae893fec9d24ba7255afaf268b615d3fa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void manageTimeoutedJobs </td>
          <td>(</td>
          <td class="paramtype">map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>jobs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Looks for jobs executing longer than JOB_TIMEOUT_SECONDS = 120. </p>
<p>For such a job a <b>NEW</b> status is set (meaning it will be scheduled again) and computer that was executing this job is removed from services table in DB. A message is printed on screen (regardles of &ndash;verbose option) and also to the file <b>computers.log</b>. </p>

</div>
</div>
<a class="anchor" id="a1f83ceb5fbaf42022a10bf37246a9ae0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printStats </td>
          <td>(</td>
          <td class="paramtype">map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>jobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt;&#160;</td>
          <td class="paramname"><em>computers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prints info on computers' load and number of tasks per priority. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">jobs</td><td>needed for stats </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">computers</td><td>needed for stats </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae725eb5a1223281b6fc69957ba6f6533"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pushBackJobsFromMessages </td>
          <td>(</td>
          <td class="paramtype">map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>jobs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; string &gt;&#160;</td>
          <td class="paramname"><em>messages</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For each message in messages creates a job (message parsing in constructor) and appends to jobs. </p>

</div>
</div>
<a class="anchor" id="a011ae6b48b7ba828575ad798068e9440"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void releaseComputer </td>
          <td>(</td>
          <td class="paramtype">vector&lt; <a class="el" href="classComputer.html">Computer</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>computers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classJob.html">Job</a> *&#160;</td>
          <td class="paramname"><em>job</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Searches the computer witch executes the job and frees its resources. </p>

</div>
</div>
<a class="anchor" id="acd054ff1e43b113756737ef6cb445111"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">connection services </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a05b80c5ffa05a1c7ddd04c06280ecaf7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">nontransaction servicesTransaction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="scheduler_8cpp.html#acd054ff1e43b113756737ef6cb445111">services</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&quot;Services transaction&quot;&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a80f69e9bae5232af5add6da3d7513a6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updateStatusFromCrankshaft </td>
          <td>(</td>
          <td class="paramtype">map&lt; int, vector&lt; <a class="el" href="classJob.html">Job</a> &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>jobs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads message queue from Crankshaft (finished jobs) </p>
<p>...and updates the <a class="el" href="classJob.html#a5cc7599f97df55d76c4f86a130285884">Job::Status</a> accordingly. </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a4cc149d5e2616cf33ceeb3a1f452f8ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int current_priority = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ad66547e0931671c3285835bdb8439794"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int current_priority_counter = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="a06b3647d8639aac2e8b658f2a6d7f581"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMessageQueue.html">MessageQueue</a> msq</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jan 2 2018 20:37:17 for Scheduler for OA Cluster by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
